<!doctype html>
<!--[if lt IE 7 ]><html itemscope itemtype="http://schema.org/Organization" id="ie6" class="ie ie-old" lang="en-US"><![endif]-->
<!--[if IE 7 ]>   <html itemscope itemtype="http://schema.org/Organization" id="ie7" class="ie ie-old" lang="en-US"><![endif]-->
<!--[if IE 8 ]>   <html itemscope itemtype="http://schema.org/Organization" id="ie8" class="ie ie-old" lang="en-US"><![endif]-->
<!--[if IE 9 ]>   <html itemscope itemtype="http://schema.org/Organization" id="ie9" class="ie" lang="en-US"><![endif]-->
<!--[if gt IE 9]><!--><html itemscope itemtype="http://schema.org/Organization" lang="en-US"><!--<![endif]-->
<head>
    <meta name="author" content="The Apache Software Foundation">

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link href="/assets/themes/zeppelin/bootstrap/css/bootstrap.css" rel="stylesheet">
    <link href="/assets/themes/zeppelin/css/style.css?body=1" rel="stylesheet" type="text/css">
    <link href="/assets/themes/zeppelin/css/syntax.css" rel="stylesheet"  type="text/css" media="screen" /> 

<!--
    <link href="/assets/themes/mahout/css/main.css" rel="stylesheet"  type="text/css" media="screen" /> 
    <link href="/assets/themes/mahout/css/global.css" rel="stylesheet"  type="text/css" media="screen" /> 
    <link href="/assets/themes/mahout/css/global__.css" rel="stylesheet"  type="text/css" media="screen" /> 
-->
    <!-- Le fav and touch icons -->
    <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
    -->

    <!-- Js -->
    <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
    <script src="/assets/themes/zeppelin/bootstrap/js/bootstrap.min.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
    }
  });
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
  </script>
  <script type="text/javascript">
    var mathjax = document.createElement('script'); 
    mathjax.type = 'text/javascript'; 
    mathjax.async = true;

    mathjax.src = ('https:' == document.location.protocol) ?
        'https://c328740.ssl.cf1.rackcdn.com/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML' : 
        'http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    
      var s = document.getElementsByTagName('script')[0]; 
    s.parentNode.insertBefore(mathjax, s);
  </script>


    <!-- JavaScript 
        <script src="/assets/themes/zeppelin/js/medium.controller.js"></script>
    <script src="/assets/themes/zeppelin/js/moment.min.js"></script>
    <script src="/assets/themes/zeppelin/js/anchor.min.js"></script>
    <script src="/assets/themes/zeppelin/js/docs.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular.min.js"></script>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <script src="http://scotch-io.github.io/js/power.js"></script>
    -->


    <!-- atom & rss feed -->
    <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">


</head>



<body class="">

    <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">
            <img src="/assets/themes/mahout/img/mahout-logo.png" width="75" alt="I'm mahout">
            Apache Mahout
          </a>
        </div>
        <nav class="navbar-collapse collapse" role="navigation">
          <ul class="nav navbar-nav navbar-right">

            <!-- Quick Start -->
            <li id="quickstart">
              <a href="/docs/0.13.0/quickstart" >Quick Start</a>
            </li>         

             <li id="samsara">
           <!-- Samsara docs  
             old http://mahout.apache.org/users/sparkbindings/faq.html

           -->
              <a href="#" data-toggle="dropdown" class="dropdown-toggle">Mahout-Samsara<b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><span><b>Reference Info</b><span></li>
                <li><a href="/docs/0.13.0/mahout-samsara/incore">In-core Reference</a></li>
                <li><a href="/docs/0.13.0/mahout-samsara/outofcore">Out-of-core Reference</a></li>
                <li><a href="/docs/0.13.0/mahout-samsara/faq">Samsara FAQ</a></li>
                <li role="separator" class="divider"></li>
                <li><span><b>Bindings</b><span></li>
                <li><a href="/docs/0.13.0/mahout-samsara/spark-bindings">Spark Bindings</a></li>
                <li><a href="/docs/0.13.0/mahout-samsara/flink-bindings">Flink Bindings</a></li>
                <li><a href="/docs/0.13.0/mahout-samsara/flink-bindings">H20 Bindings</a></li>
              </ul>
            </li>

             <li id="tutorials">
           <!-- Tutorials -->
              <a href="#" data-toggle="dropdown" class="dropdown-toggle">Tutorials<b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><span><b>Spark Examples using Samsara</b><span></li>
                <li><a href="/docs/0.13.0/tutorials/samsara-spark-shell">Samsara in Spark Shell</a></li>
                <li><a href="/docs/0.13.0/tutorials/build-app">Samsara Spark Application</a></li>
                <li><a href="/docs/0.13.0/tutorials/text-classification">Text Classification</a></li>
                <li role="separator" class="divider"></li>
                <li><span><b>Fl</b><span></li>
                <li><a href="/docs/0.13.1-SNAPSHOT">tbd1</a></li>
                <li><a href="/docs/0.13.1-SNAPSHOT">tbd2</a></li>
                <li role="separator" class="divider"></li>
                <li><span><b>MapReduce</b><span></li>
                <li><a href="/docs/0.13.1-SNAPSHOT">tbd1</a></li>
                <li><a href="/docs/0.13.1-SNAPSHOT">tbd2</a></li>
              </ul>
            </li>


            <!-- Algorithms (Samsara / MR) -->
            <li id="algorithms">
              <a href="#" data-toggle="dropdown" class="dropdown-toggle">Algorithms<b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><span><b>Samsara Code</b><span></li>
                <li><a href="/docs/0.13.0/algorithms/samsara/dssvd">Dist SVD</a></li>
                <li><a href="/docs/0.13.0/algorithms/samsara/dspca">Dist PCA</a></li>
                <li><a href="/docs/0.13.0/algorithms/samsara/dqr">Dist QR</a></li>
                <li><a href="/docs/0.13.0/algorithms/samsara/dals">Dist ALS</a></li>
                <li role="separator" class="divider"></li>
                <li><span><b>Command Line</b><span></li>
                <li><a href="/docs/0.13.0">algo1</a></li>
                <li><a href="/docs/0.13.0">algo2</a></li>
                <li role="separator" class="divider"></li>
                <li><span><b>xxxx</b>&nbsp;(xxxxx)<span></li>
                <li><a href="/docs/0.13.1-SNAPSHOT">xxxxx</a></li>
              </ul>
            </li>

            <!-- Scala Docs -->
            <li id="scaladocs">
              <a href="tbd" data-toggle="dropdown" class="dropdown-toggle">Scala Docs<b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li class="title"><span><b>TODO - Needs update per new scaladocs</b><span></li>
                <li><a href="http://apache.github.io/mahout/0.10.1/docs/mahout-math/index.html">Mahout Math</a></li>
                <li><a href="http://apache.github.io/mahout/0.10.1/docs/mahout-math-scala/index.html">Mahout Math Scala bindings</a></li>
                <li><a href="http://apache.github.io/mahout/0.10.1/docs/mahout-math/index.htmlhttp://apache.github.io/mahout/0.10.1/docs/mahout-spark/index.html">Mahout Spark bindings</a></li>
                <li><a href="http://apache.github.io/mahout/0.10.1/docs/mahout-math/index.html">Mahout Spark bindings shell</a></li>
                <li><a href="http://apache.github.io/mahout/0.10.1/docs/mahout-math/index.html">Mahout H2O backend Scaladoc</a></li>
                <li><a href="http://apache.github.io/mahout/0.10.1/docs/mahout-math/index.html">Mahout H2O backend Javadoc</a></li>
                <li><a href="http://apache.github.io/mahout/0.10.1/docs/mahout-math/index.html">Mahout HDFS</a></li>
                <li><a href="http://apache.github.io/mahout/0.10.1/docs/mahout-math/index.html">Mahout Map-Reduce</a></li>
                <li><a href="http://apache.github.io/mahout/0.10.1/docs/mahout-math/index.html">Mahout Examples</a></li>
                <li><a href="http://apache.github.io/mahout/0.10.1/docs/mahout-math/index.html">Mahout Integration</a></li>
              </ul>
            </li>



















        </ul>
        </nav><!--/.navbar-collapse -->
      </div>
    </div>

        <article>
        <div class="container">
            <div class="row">
                <div class="col-md-10 col-md-offset-1">
                    <h2 id="mahout-samsaras-in-core-linear-algebra-dsl-reference">Mahout-Samsara’s In-Core Linear Algebra DSL Reference</h2>

<h4 id="imports">Imports</h4>

<p>The following imports are used to enable Mahout-Samsara’s Scala DSL bindings for in-core Linear Algebra:</p>

<pre><code>import org.apache.mahout.math._
import scalabindings._
import RLikeOps._
</code></pre>

<h4 id="inline-initalization">Inline initalization</h4>

<p>Dense vectors:</p>

<pre><code>val densVec1: Vector = (1.0, 1.1, 1.2)
val denseVec2 = dvec(1, 0, 1,1 ,1,2)
</code></pre>

<p>Sparse vectors:</p>

<pre><code>val sparseVec1: Vector = (5 -&gt; 1.0) :: (10 -&gt; 2.0) :: Nil
val sparseVec1 = svec((5 -&gt; 1.0) :: (10 -&gt; 2.0) :: Nil)

// to create a vector with specific cardinality
val sparseVec1 = svec((5 -&gt; 1.0) :: (10 -&gt; 2.0) :: Nil, cardinality = 20)
</code></pre>

<p>Inline matrix initialization, either sparse or dense, is always done row wise.</p>

<p>Dense matrices:</p>

<pre><code>val A = dense((1, 2, 3), (3, 4, 5))
</code></pre>

<p>Sparse matrices:</p>

<pre><code>val A = sparse(
          (1, 3) :: Nil,
          (0, 2) :: (1, 2.5) :: Nil
              )
</code></pre>

<p>Diagonal matrix with constant diagonal elements:</p>

<pre><code>diag(3.5, 10)
</code></pre>

<p>Diagonal matrix with main diagonal backed by a vector:</p>

<pre><code>diagv((1, 2, 3, 4, 5))
</code></pre>

<p>Identity matrix:</p>

<pre><code>eye(10)
</code></pre>

<p>####Slicing and Assigning</p>

<p>Getting a vector element:</p>

<pre><code>val d = vec(5)
</code></pre>

<p>Setting a vector element:</p>

<pre><code>vec(5) = 3.0
</code></pre>

<p>Getting a matrix element:</p>

<pre><code>val d = m(3,5)
</code></pre>

<p>Setting a matrix element:</p>

<pre><code>M(3,5) = 3.0
</code></pre>

<p>Getting a matrix row or column:</p>

<pre><code>val rowVec = M(3, ::)
val colVec = M(::, 3)
</code></pre>

<p>Setting a matrix row or column via vector assignment:</p>

<pre><code>M(3, ::) := (1, 2, 3)
M(::, 3) := (1, 2, 3)
</code></pre>

<p>Setting a subslices of a matrix row or column:</p>

<pre><code>a(0, 0 to 1) = (3, 5)
</code></pre>

<p>Setting a subslices of a matrix row or column via vector assignment:</p>

<pre><code>a(0, 0 to 1) := (3, 5)
</code></pre>

<p>Getting a matrix as from matrix contiguous block:</p>

<pre><code>val B = A(2 to 3, 3 to 4)
</code></pre>

<p>Assigning a contiguous block to a matrix:</p>

<pre><code>A(0 to 1, 1 to 2) = dense((3, 2), (3 ,3))
</code></pre>

<p>Assigning a contiguous block to a matrix using the matrix assignment operator:</p>

<pre><code>A(o to 1, 1 to 2) := dense((3, 2), (3, 3))
</code></pre>

<p>Assignment operator used for copying between vectors or matrices:</p>

<pre><code>vec1 := vec2
M1 := M2
</code></pre>

<p>Assignment operator using assignment through a functional literal for a matrix:</p>

<pre><code>M := ((row, col, x) =&gt; if (row == col) 1 else 0
</code></pre>

<p>Assignment operator using assignment through a functional literal for a vector:</p>

<pre><code>vec := ((index, x) =&gt; sqrt(x)
</code></pre>

<h4 id="blas-like-operations">BLAS-like operations</h4>

<p>Plus/minus either vector or numeric with assignment or not:</p>

<pre><code>a + b
a - b
a + 5.0
a - 5.0
</code></pre>

<p>Hadamard (elementwise) product, either vector or matrix or numeric operands:</p>

<pre><code>a * b
a * 0.5
</code></pre>

<p>Operations with assignment:</p>

<pre><code>a += b
a -= b
a += 5.0
a -= 5.0
a *= b
a *= 5
</code></pre>

<p><em>Some nuanced rules</em>:</p>

<p>1/x in R (where x is a vector or a matrix) is elementwise inverse.  In scala it would be expressed as:</p>

<pre><code>val xInv = 1 /: x
</code></pre>

<p>and R’s 5.0 - x would be:</p>

<pre><code>val x1 = 5.0 -: x
</code></pre>

<p><em>note: All assignment operations, including :=, return the assignee just like in C++</em>:</p>

<pre><code>a -= b 
</code></pre>

<p>assigns <strong>a - b</strong> to <strong>b</strong> (in-place) and returns <strong>b</strong>.  Similarly for <strong>a /=: b</strong> or <strong>1 /=: v</strong></p>

<p>Dot product:</p>

<pre><code>a dot b
</code></pre>

<p>Matrix and vector equivalency (or non-equivalency).  <strong>Dangerous, exact equivalence is rarely useful, better to use norm comparisons with an allowance of small errors.</strong></p>

<pre><code>a === b
a !== b
</code></pre>

<p>Matrix multiply:</p>

<pre><code>a %*% b
</code></pre>

<p>Optimized Right Multiply with a diagonal matrix:</p>

<pre><code>diag(5, 5) :%*% b
</code></pre>

<p>Optimized Left Multiply with a diagonal matrix:</p>

<pre><code>A %*%: diag(5, 5)
</code></pre>

<p>Second norm, of a vector or matrix:</p>

<pre><code>a.norm
</code></pre>

<p>Transpose:</p>

<pre><code>val Mt = M.t
</code></pre>

<p><em>note: Transposition is currently handled via view, i.e. updating a transposed matrix will be updating the original.</em>  Also computing something like <code>\(\mathbf{X^\top}\mathbf{X}\)</code>:</p>

<pre><code>val XtX = X.t %*% X
</code></pre>

<p>will not therefore incur any additional data copying.</p>

<h4 id="decompositions">Decompositions</h4>

<p>Matrix decompositions require an additional import:</p>

<pre><code>import org.apache.mahout.math.decompositions._
</code></pre>

<p>All arguments in the following are matricies.</p>

<p><strong>Cholesky decomposition</strong></p>

<pre><code>val ch = chol(M)
</code></pre>

<p><strong>SVD</strong></p>

<pre><code>val (U, V, s) = svd(M)
</code></pre>

<p><strong>EigenDecomposition</strong></p>

<pre><code>val (V, d) = eigen(M)
</code></pre>

<p><strong>QR decomposition</strong></p>

<pre><code>val (Q, R) = qr(M)
</code></pre>

<p><strong>Rank</strong>: Check for rank deficiency (runs rank-revealing QR)</p>

<pre><code>M.isFullRank
</code></pre>

<p><strong>In-core SSVD</strong></p>

<pre><code>Val (U, V, s) = ssvd(A, k = 50, p = 15, q = 1)
</code></pre>

<p><strong>Solving linear equation systems and matrix inversion:</strong> fully similar to R semantics; there are three forms of invocation:</p>

<p>Solve <code>\(\mathbf{AX}=\mathbf{B}\)</code>:</p>

<pre><code>solve(A, B)
</code></pre>

<p>Solve <code>\(\mathbf{Ax}=\mathbf{b}\)</code>:</p>

<pre><code>solve(A, b)
</code></pre>

<p>Compute <code>\(\mathbf{A^{-1}}\)</code>:</p>

<pre><code>solve(A)
</code></pre>

<h4 id="misc">Misc</h4>

<p>Vector cardinality:</p>

<pre><code>a.length
</code></pre>

<p>Matrix cardinality:</p>

<pre><code>m.nrow
m.ncol
</code></pre>

<p>Means and sums:</p>

<pre><code>m.colSums
m.colMeans
m.rowSums
m.rowMeans
</code></pre>

<p>Copy-By-Value:</p>

<pre><code>val b = a cloned
</code></pre>

<h4 id="random-matrices">Random Matrices</h4>

<p><code>\(\mathcal{U}\)</code>(0,1) random matrix view:</p>

<pre><code>val incCoreA = Matrices.uniformView(m, n, seed)
</code></pre>

<p><code>\(\mathcal{U}\)</code>(-1,1) random matrix view:</p>

<pre><code>val incCoreA = Matrices.symmetricUniformView(m, n, seed)
</code></pre>

<p><code>\(\mathcal{N}\)</code>(-1,1) random matrix view:</p>

<pre><code>val incCoreA = Matrices.gaussianView(m, n, seed)
</code></pre>

<h4 id="iterators">Iterators</h4>

<p>Mahout-Math already exposes a number of iterators.  Scala code just needs the following imports to enable implicit conversions to scala iterators.</p>

<pre><code>import collection._
import JavaConversions._
</code></pre>

<p>Iterating over rows in a Matrix:</p>

<pre><code>for (row &lt;- m) {
  ... do something with row
}
</code></pre>

<!--Iterating over non-zero and all elements of a vector:
*Note that Vector.Element also has some implicit syntatic sugar, e.g to add 5.0 to every non-zero element of a matrix, the following code may be used:*

    for (row <- m; el <- row.nonZero) el = 5.0 + el
    ... or 
    for (row <- m; el <- row.nonZero) el := 5.0 + el
    
Similarly **row.all** produces an iterator over all elements in a row (Vector). 
-->

<p>For more information including information on Mahout-Samsara’s out-of-core Linear algebra bindings see: <a href="http://mahout.apache.org/users/sparkbindings/ScalaSparkBindings.pdf">Mahout Scala Bindings and Mahout Spark Bindings for Linear Algebra Subroutines</a></p>


                </div>
            </div>
        </div>
    </article>


    <footer class="site-footer">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <p class="text-muted">This text is footer text. Footer text goes here.</p>
                </div>
            </div>
        </div>
    </footer>

    </body>
</html>
